
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.1">
    
    
      
        <title>ODBC - HylaFAX Handbook</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.23b6d78a.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hylafax-enterprise-guide-for-odbc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="HylaFAX Handbook" class="md-header__button md-logo" aria-label="HylaFAX Handbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HylaFAX Handbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ODBC
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../quickstart/appliance-installation/" class="md-tabs__link">
        Quickstart Guide
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../overview/" class="md-tabs__link md-tabs__link--active">
        Enterprise Guide
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="HylaFAX Handbook" class="md-nav__button md-logo" aria-label="HylaFAX Handbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    HylaFAX Handbook
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Quickstart Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Quickstart Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Quickstart Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/appliance-installation/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/installing-the-iso/" class="md-nav__link">
        Installing the iso
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/activating-the-license/" class="md-nav__link">
        Activate License
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/configure-networking/" class="md-nav__link">
        Configure Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/configuring-mail/" class="md-nav__link">
        Configuring Mail
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/enabling-iFAX-support-access/" class="md-nav__link">
        Enabling iFAX Support Access
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/configuring-telco-connections/" class="md-nav__link">
        Configuring Telco Connections
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/configure-dialing-options/" class="md-nav__link">
        Configure Dialing Options
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/web-interface-start-up/" class="md-nav__link">
        Web Interface Startup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/web-interface-admin-basics/" class="md-nav__link">
        Web Interface Admin Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/web-interface-DID-routes/" class="md-nav__link">
        Web Interface DID Routes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/notes/" class="md-nav__link">
        Notes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Enterprise Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Enterprise Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Enterprise Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../license-activation/" class="md-nav__link">
        License Activation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../inbound-fax-routing/" class="md-nav__link">
        Inbound FAX Routing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sending-faxes/" class="md-nav__link">
        Sending Faxes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../client-access/" class="md-nav__link">
        Client Access
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hylafsp/" class="md-nav__link">
        HylaFSP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../email-templates/" class="md-nav__link">
        Email Templates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../firewall-configuration/" class="md-nav__link">
        Firewall Configuration
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          ODBC
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        ODBC
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#preface" class="md-nav__link">
    Preface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-odbc-database-server" class="md-nav__link">
    Configure ODBC Database Server
  </a>
  
    <nav class="md-nav" aria-label="Configure ODBC Database Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#postgresql-installation" class="md-nav__link">
    PostgreSQL installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-postgresql" class="md-nav__link">
    Configure PostgreSQL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-postgresql" class="md-nav__link">
    Start PostgreSQL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-hylafax-userdatabase-for-postgresql" class="md-nav__link">
    Create HylaFAX User/Database for PostgreSQL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-hylafax-schema" class="md-nav__link">
    Import HylaFAX Schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-odbc" class="md-nav__link">
    Setup ODBC
  </a>
  
    <nav class="md-nav" aria-label="Setup ODBC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mariadb-installation" class="md-nav__link">
    MariaDB installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-hylafax-userdatabase-on-mariadb" class="md-nav__link">
    Create HylaFAX User/Database on MariaDB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-hylafax-schema_1" class="md-nav__link">
    Import HylaFAX Schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-odbc_1" class="md-nav__link">
    Setup ODBC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-odbc-connection" class="md-nav__link">
    Test the ODBC Connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-hylafax-enterprise-with-odbc" class="md-nav__link">
    Configure HylaFAX Enterprise with ODBC
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieving-data-from-odbc" class="md-nav__link">
    Retrieving Data from ODBC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#populating-the-database" class="md-nav__link">
    Populating the Database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checking-a-jobs-final-status" class="md-nav__link">
    Checking a job’s final status
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ldap/" class="md-nav__link">
        LDAP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../recv-xferfaxstats/" class="md-nav__link">
        RECV and Xferfaxstats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../web-ssl/" class="md-nav__link">
        SSL for Web Interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cron-jobs/" class="md-nav__link">
        Cron Jobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../samba/" class="md-nav__link">
        Samba Share
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../maxdials-maxtries/" class="md-nav__link">
        MaxDials and MaxTries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lang-date/" class="md-nav__link">
        Changing the Language and Date Format 
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        Troubleshooting and FAQ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#preface" class="md-nav__link">
    Preface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-odbc-database-server" class="md-nav__link">
    Configure ODBC Database Server
  </a>
  
    <nav class="md-nav" aria-label="Configure ODBC Database Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#postgresql-installation" class="md-nav__link">
    PostgreSQL installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-postgresql" class="md-nav__link">
    Configure PostgreSQL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-postgresql" class="md-nav__link">
    Start PostgreSQL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-hylafax-userdatabase-for-postgresql" class="md-nav__link">
    Create HylaFAX User/Database for PostgreSQL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-hylafax-schema" class="md-nav__link">
    Import HylaFAX Schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-odbc" class="md-nav__link">
    Setup ODBC
  </a>
  
    <nav class="md-nav" aria-label="Setup ODBC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mariadb-installation" class="md-nav__link">
    MariaDB installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-hylafax-userdatabase-on-mariadb" class="md-nav__link">
    Create HylaFAX User/Database on MariaDB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-hylafax-schema_1" class="md-nav__link">
    Import HylaFAX Schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-odbc_1" class="md-nav__link">
    Setup ODBC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-odbc-connection" class="md-nav__link">
    Test the ODBC Connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-hylafax-enterprise-with-odbc" class="md-nav__link">
    Configure HylaFAX Enterprise with ODBC
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieving-data-from-odbc" class="md-nav__link">
    Retrieving Data from ODBC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#populating-the-database" class="md-nav__link">
    Populating the Database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checking-a-jobs-final-status" class="md-nav__link">
    Checking a job’s final status
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="hylafax-enterprise-guide-for-odbc">HylaFAX Enterprise Guide for ODBC<a class="headerlink" href="#hylafax-enterprise-guide-for-odbc" title="Permanent link">&para;</a></h1>
<h2 id="preface">Preface<a class="headerlink" href="#preface" title="Permanent link">&para;</a></h2>
<p>HylaFAX Enterprise will utilize an ODBC connection for storing data regarding both inbound and outbound faxing. In the case of inbound faxing, it is possible to route incoming faxes using database rows which, presumably, some automated provisioning agent would be adding/populating.</p>
<p>In the case of outbound faxing, ODBC usage enables a data warehouse for reporting on fax traffic including final transmission status, bitrate, duration of transmission, the receiver’s station identifier, etc.</p>
<p>With clever use of stored procedures and triggers some business logic can added to both transmission and reception of faxes, and this is yet another point of integration in addition to the client/server protocol that some customers use to get data out of HylaFAX. For instance, if a received fax needs to be injected into some customer-facing application, you could execute a stored procedure to capture the fax (which can be stored in the database) and move it to a new table/schema.</p>
<p><ins>NOTE</ins>:</p>
<p>This guide will explain how to use PostgreSQL and MariaDB on CentOS 7 64-bit with HylaFAX Enterprise.</p>
<h2 id="configure-odbc-database-server">Configure ODBC Database Server<a class="headerlink" href="#configure-odbc-database-server" title="Permanent link">&para;</a></h2>
<h3 id="postgresql-installation">PostgreSQL installation<a class="headerlink" href="#postgresql-installation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># yum install postgresql-server postgresql-odbc</span>
<span class="c1"># postgresql-setup initdb</span>
<span class="c1"># systemctl enable postgresql</span>
</code></pre></div>
<h3 id="configure-postgresql">Configure PostgreSQL<a class="headerlink" href="#configure-postgresql" title="Permanent link">&para;</a></h3>
<p>Edit <code>/var/lib/pgsql/data/pg_hba.conf</code>:
Add the authentication line BEFORE the default ident lines:</p>
<div class="highlight"><pre><span></span><code><span class="nb">local</span>   hylafax        hylafax                                  md5
host    hylafax        hylafax       <span class="m">127</span>.0.0.1/32               md5
host    hylafax        hylafax       ::1/128                    md5
</code></pre></div>
<p>If you need network access, use something like:</p>
<div class="highlight"><pre><span></span><code>host    hylafax        hylafax       <span class="m">192</span>.168.1.0/24             md5
</code></pre></div>
<p>The file is well commented.</p>
<p>Edit <code>/var/lib/pgsql/data/postgresql.conf</code>
Important variables are:
<div class="highlight"><pre><span></span><code>    <span class="nv">listen_addresses</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span>
    <span class="nv">max_connections</span> <span class="o">=</span> <span class="m">512</span>
    <span class="nv">shared_buffers</span> <span class="o">=</span> <span class="m">1024</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>max_connections needed are <span class="o">(</span>minimum<span class="o">)</span>:
    <span class="m">2</span> * N + <span class="m">1</span> + n + H
where:
    N is the number of channels
    <span class="m">1</span> is <span class="k">for</span> faxq
    n is the number of simultaneous faxq job preparations <span class="o">(</span>n &lt;<span class="o">=</span> N<span class="o">)</span>
    H is the number of simultaneous hfaxd connections
</code></pre></div>
These minimum settings do not take into account any other necessary connections from non-hylafax related processes (like any other tools/scripts, or anything that faxrcvd might do, etc).</p>
<h3 id="start-postgresql">Start PostgreSQL<a class="headerlink" href="#start-postgresql" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># systemctl start postgresql</span>
</code></pre></div>
<h3 id="create-hylafax-userdatabase-for-postgresql">Create HylaFAX User/Database for PostgreSQL<a class="headerlink" href="#create-hylafax-userdatabase-for-postgresql" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># su - postgres</span>
$ createdb hylafax
$ createuser -A -D -P hylafax
Password: ee
$ createlang plpgsql hylafax
$ <span class="nb">exit</span>
</code></pre></div>
<h3 id="import-hylafax-schema">Import HylaFAX Schema<a class="headerlink" href="#import-hylafax-schema" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># psql -U hylafax hylafax &lt; /var/spool/hylafax/ifax/sql/postgres.sql</span>
</code></pre></div>
<h3 id="setup-odbc">Setup ODBC<a class="headerlink" href="#setup-odbc" title="Permanent link">&para;</a></h3>
<p>Edit <code>/etc/odbc.ini</code></p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>hylafax<span class="o">]</span>
<span class="nv">Driver</span>      <span class="o">=</span> /usr/lib64/psqlodbc.so
<span class="nv">Database</span>    <span class="o">=</span> hylafax
<span class="nv">Server</span>      <span class="o">=</span> localhost
<span class="nv">UserName</span>    <span class="o">=</span> hylafax
<span class="nv">Password</span>    <span class="o">=</span> ee
<span class="nv">ReadOnly</span>    <span class="o">=</span> No
<span class="nv">Debug</span>       <span class="o">=</span> <span class="m">0</span>
<span class="nv">CommLog</span>     <span class="o">=</span> <span class="m">0</span>
<span class="nv">UseServerSidePrepare</span> <span class="o">=</span> <span class="m">0</span>
</code></pre></div>
<h4 id="mariadb-installation">MariaDB installation<a class="headerlink" href="#mariadb-installation" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># yum install mariadb mariadb-server mysql-connector-odbc</span>
<span class="c1"># systemctl start mariadb</span>
<span class="c1"># systemctl enable mariadb</span>
</code></pre></div>
<h4 id="create-hylafax-userdatabase-on-mariadb">Create HylaFAX User/Database on MariaDB<a class="headerlink" href="#create-hylafax-userdatabase-on-mariadb" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># mysqladmin create hylafax</span>
<span class="c1"># mysql mysql</span>
</code></pre></div>
<p>Execute these SQL queries:</p>
<div class="highlight"><pre><span></span><code>GRANT ALL PRIVILEGES ON hylafax.* TO <span class="s1">&#39;hylafax&#39;</span>@<span class="s1">&#39;localhost&#39;</span> IDENTIFIED BY <span class="s1">&#39;ee&#39;</span><span class="p">;</span>
</code></pre></div>
<p>If you need network access, use something like:
<div class="highlight"><pre><span></span><code>GRANT ALL PRIVILEGES ON hylafax.* TO <span class="s1">&#39;hylafax&#39;</span>@<span class="s1">&#39;209.166.32.52&#39;</span> IDENTIFIED BY <span class="s1">&#39;ee&#39;</span><span class="p">;</span>
Update privileges:
FLUSH PRIVILEGES<span class="p">;</span>
exit<span class="p">;</span>
</code></pre></div></p>
<h4 id="import-hylafax-schema_1">Import HylaFAX Schema<a class="headerlink" href="#import-hylafax-schema_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># mysql -uhylafax -pee hylafax &lt; /var/spool/hylafax/ifax/sql/mysql.sql</span>
</code></pre></div>
<h4 id="setup-odbc_1">Setup ODBC<a class="headerlink" href="#setup-odbc_1" title="Permanent link">&para;</a></h4>
<p>Edit <code>/etc/odbc.ini</code></p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>hylafax<span class="o">]</span>
<span class="nv">Driver</span>      <span class="o">=</span> /usr/lib64/libmyodbc5.so
<span class="nv">Database</span>    <span class="o">=</span> hylafax
<span class="nv">Server</span>      <span class="o">=</span> localhost
<span class="nv">User</span>        <span class="o">=</span> hylafax
<span class="nv">Password</span>    <span class="o">=</span> ee
<span class="p">;</span><span class="nv">ReadOnly</span>   <span class="o">=</span> No
</code></pre></div>
<h4 id="test-the-odbc-connection">Test the ODBC Connection<a class="headerlink" href="#test-the-odbc-connection" title="Permanent link">&para;</a></h4>
<p>Test the connection using <code>isql hylafax</code></p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>root@hylafax ~<span class="o">]</span><span class="c1"># isql hylafax</span>
+----------------------------------------+
<span class="p">|</span> Connected!                             <span class="p">|</span>
<span class="p">|</span>                                        <span class="p">|</span>
<span class="p">|</span> sql-statement                          <span class="p">|</span>
<span class="p">|</span> <span class="nb">help</span> <span class="o">[</span>tablename<span class="o">]</span>                       <span class="p">|</span>
<span class="p">|</span> quit                                   <span class="p">|</span>
<span class="p">|</span>                                        <span class="p">|</span>
+----------------------------------------+
SQL&gt; SELECT count<span class="o">(</span>*<span class="o">)</span> FROM hylafax_statements<span class="p">;</span>
+-----------------+
<span class="p">|</span> count           <span class="p">|</span>
+-----------------+
<span class="p">|</span> <span class="m">13</span>              <span class="p">|</span>
+-----------------+
SQLRowCount returns <span class="m">1</span>
<span class="m">1</span> rows fetched
SQL&gt; quit
</code></pre></div>
<h4 id="configure-hylafax-enterprise-with-odbc">Configure HylaFAX Enterprise with ODBC<a class="headerlink" href="#configure-hylafax-enterprise-with-odbc" title="Permanent link">&para;</a></h4>
<p>Create <code>/var/spool/hylafax/etc/CONFIG/database</code> with the following content:</p>
<div class="highlight"><pre><span></span><code>DataInitialize:    <span class="s2">&quot;odbc: dsn=hylafax&quot;</span>
<span class="c1">#DataOption:       &quot;odbc: username=hylafax&quot;</span>
<span class="c1">#DataOption:       &quot;odbc: password=ee&quot;</span>
DataSource:        <span class="s2">&quot;FaxRecvInfo: odbc&quot;</span>
DataSource:        <span class="s2">&quot;FaxAcctInfo: odbc&quot;</span>
</code></pre></div>
<p>Afterwards, configure your modem devices to include that file. For example, in
<code>/var/spool/hylafax/etc/CONFIG/boston</code> add:</p>
<div class="highlight"><pre><span></span><code>Include:           etc/CONFIG/database
</code></pre></div>
<p>Next, restart faxgetty and/or btgetty proccesses in order to connect them to ODBC:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># for i in /var/spool/hylafax/FIFO.*; do echo Q &gt; $i; done</span>
</code></pre></div>
<p>If there is an ODBC connection problem, the faxgetty/btgetty processes will fail to start properly. You  can  verify  whether  there  were  errors  while  connecting  to  the  database  by executing: 
<div class="highlight"><pre><span></span><code><span class="c1"># grep -i odbc /var/log/messages</span>
</code></pre></div></p>
<p>If HylaFAX is having difficulty connecting to ODBC, try uncommenting the 'DataOption' lines above. Should  you  need  to  disable  ODBC,  simply  comment  out  the  Include line you added above.</p>
<h2 id="retrieving-data-from-odbc">Retrieving Data from ODBC<a class="headerlink" href="#retrieving-data-from-odbc" title="Permanent link">&para;</a></h2>
<p>Here are sample SQL queries for retrieving records from the 'communication' table:
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">tstart</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">commid</span><span class="p">,</span> <span class="n">jobid</span><span class="p">,</span> <span class="n">mailaddr</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">csi</span><span class="p">,</span> <span class="n">npages</span><span class="p">,</span> <span class="n">status</span> <span class="k">FROM</span> <span class="n">communication</span> <span class="k">WHERE</span> <span class="n">dest</span> <span class="o">=</span> <span class="s1">&#39;12155558774&#39;</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="n">tstart</span><span class="p">,</span> <span class="n">commid</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">jobid</span><span class="p">,</span> <span class="n">npages</span><span class="p">,</span> <span class="n">status</span> <span class="k">FROM</span> <span class="n">communication</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">tstart</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">40</span><span class="p">;</span>
</code></pre></div></p>
<p>A description of each column can be found in the xferfaxlog manpage.</p>
<h2 id="populating-the-database">Populating the Database<a class="headerlink" href="#populating-the-database" title="Permanent link">&para;</a></h2>
<p>You  can  use  the  xferfaxlog2db.php  script  from  http://people.ifax.com/~david/scripts/  to  export  your xferfaxlog  data  into  the  ODBC  database.  Only  records  not  currently  available  in  the  database  will  be created.</p>
<h2 id="checking-a-jobs-final-status">Checking a job’s final status<a class="headerlink" href="#checking-a-jobs-final-status" title="Permanent link">&para;</a></h2>
<p>The HylaFAX job 'status' is available in the 'status' column of the 'communication' table. On success, the status field will be empty. A call that ended with an error will report the error in the 'status' column. Please  note  that  the  /var/spool/hylafax/etc/xferfaxlog  data and  the  'communication'  database  table contain call detail records. If you want to know the final status of a job, it’s better to add that column to the database and then update it via the FaxNotify script.</p>
<p>For example, you’d add the following to <code>/var/spool/hylafax/etc/FaxNotify</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Add final status (e.g. &#39;done&#39;, &#39;failed&#39;, etc) to the communication table</span>
<span class="c1"># See `man notify` for list of statuses</span>
<span class="nv">DB</span><span class="o">=</span>hylafax
<span class="nv">USER</span><span class="o">=</span>hylafax
<span class="nv">PASS</span><span class="o">=</span>ee
<span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$WHY</span><span class="s2">&quot;</span> <span class="k">in</span>
  blocked<span class="o">)</span>    <span class="p">;;</span>
  requeued<span class="o">)</span>   <span class="p">;;</span>
  *<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;UPDATE communication SET finalstatus=&#39;</span><span class="nv">$WHY</span><span class="s2">&#39; WHERE commid = &#39;</span><span class="nv">$COMMID</span><span class="s2">&#39;&quot;</span> <span class="p">|</span> isql
<span class="nv">$DB</span> <span class="nv">$USER</span> <span class="nv">$PASS</span>
   <span class="p">;;</span>
<span class="k">esac</span>
</code></pre></div>
<p>You must apply the following schema change for both PostgreSQL and MariaDB:</p>
<div class="highlight"><pre><span></span><code><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">communication</span> <span class="k">ADD</span> <span class="n">finalstatus</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div>
<p>You must also apply the following schema change for MariaDB:</p>
<p><div class="highlight"><pre><span></span><code><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">communication</span> <span class="n">CHANGE</span> <span class="n">tstart</span> <span class="n">tstart</span> <span class="k">TIMESTAMP</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">;</span>
</code></pre></div>
Once  you’ve  applied  these  changes,  you’ll  be  able  to  query  the  database  regarding  jobs  where  the finalstatus is not null and get the true final status of the job.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">communication</span> <span class="k">WHERE</span> <span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;SEND&#39;</span> <span class="k">AND</span> <span class="n">finalstatus</span> <span class="k">is</span> <span class="k">not</span> <span class="k">null</span><span class="p">;</span>
</code></pre></div>
<p>You can use the following queries to retroactively set the finalstatus column:</p>
<div class="highlight"><pre><span></span><code><span class="k">UPDATE</span> <span class="n">communication</span> <span class="k">SET</span> <span class="n">finalstatus</span><span class="o">=</span><span class="s1">&#39;done&#39;</span> <span class="k">WHERE</span> <span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;SEND&#39;</span> <span class="k">AND</span> <span class="n">finalstatus</span> <span class="k">is</span> <span class="k">null</span> <span class="k">AND</span> <span class="n">status</span> <span class="k">is</span> <span class="k">null</span><span class="p">;</span>
<span class="k">UPDATE</span> <span class="n">communication</span> <span class="k">SET</span> <span class="n">finalstatus</span><span class="o">=</span><span class="s1">&#39;failed&#39;</span> <span class="k">WHERE</span> <span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;SEND&#39;</span> <span class="k">AND</span> <span class="n">finalstatus</span> <span class="k">is</span> <span class="k">null</span> <span class="k">AND</span> <span class="n">status</span> <span class="k">like</span> <span class="s1">&#39;%too many%&#39;</span><span class="p">;</span>
</code></pre></div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../firewall-configuration/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Firewall Configuration" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Firewall Configuration
            </div>
          </div>
        </a>
      
      
        
        <a href="../ldap/" class="md-footer__link md-footer__link--next" aria-label="Next: LDAP" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              LDAP
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.c7dec7e7.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.da79ceb7.min.js"></script>
      
    
  </body>
</html>