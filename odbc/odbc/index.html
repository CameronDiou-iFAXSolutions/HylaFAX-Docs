
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.1">
    
    
      
        <title>Odbc - HylaFAX Enterprise Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.23b6d78a.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#yum-install-postgresql-server-postgresql-odbc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="HylaFAX Enterprise Guide" class="md-header__button md-logo" aria-label="HylaFAX Enterprise Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HylaFAX Enterprise Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Odbc
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../quickstart/appliance-installation/" class="md-tabs__link">
        Quickstart Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../master/overview/" class="md-tabs__link">
        Enterprise Guide
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="HylaFAX Enterprise Guide" class="md-nav__button md-logo" aria-label="HylaFAX Enterprise Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    HylaFAX Enterprise Guide
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Quickstart Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Quickstart Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Quickstart Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/appliance-installation/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/installing-the-iso/" class="md-nav__link">
        Installing the iso
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/activating-the-license/" class="md-nav__link">
        Activate License
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/configure-networking/" class="md-nav__link">
        Configure Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/configuring-mail/" class="md-nav__link">
        Configuring Mail
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/enabling-iFAX-support-access/" class="md-nav__link">
        Enabling iFAX Support Access
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/configuring-telco-connections/" class="md-nav__link">
        Configuring Telco Connections
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/configure-dialing-options/" class="md-nav__link">
        Configure Dialing Options
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/web-interface-start-up/" class="md-nav__link">
        Web Interface Startup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/web-interface-admin-basics/" class="md-nav__link">
        Web Interface Admin Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/web-interface-DID-routes/" class="md-nav__link">
        Web Interface DID Routes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/notes/" class="md-nav__link">
        Notes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Enterprise Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Enterprise Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Enterprise Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../master/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../master/license-activation/" class="md-nav__link">
        License Activation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../master/inbound-fax-routing/" class="md-nav__link">
        Inbound FAX Routing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../master/sending-faxes/" class="md-nav__link">
        Sending Faxes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../master/client-access/" class="md-nav__link">
        Client Access
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../master/email-templates/" class="md-nav__link">
        Email Templates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../master/firewall-configuration/" class="md-nav__link">
        Firewall Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../master/cron-jobs/" class="md-nav__link">
        Cron Jobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../master/troubleshooting/" class="md-nav__link">
        Troubleshooting and FAQ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<p>HylaFAX Enterprise Guide for ODBC</p>
<ol>
<li>Preface</li>
</ol>
<p>HylaFAX Enterprise will utilize an ODBC connection for storing data regarding both inbound and outbound faxing. In the case of inbound faxing, it is possible to route incoming faxes using database rows which, presumably, some automated provisioning agent would be adding/populating.</p>
<p>In the case of outbound faxing, ODBC usage enables a data warehouse for reporting on fax traffic including final transmission status, bitrate, duration of transmission, the receiver’s station identifier, etc.</p>
<p>With clever use of stored procedures and triggers some business logic can added to both transmission and reception of faxes, and this is yet another point of integration in addition to the client/server protocol that some customers use to get data out of HylaFAX. For instance, if a received fax needs to be injected into some customer-facing application, you could execute a stored procedure to capture the fax (which can be stored in the database) and move it to a new table/schema.</p>
<p>***INFO:</p>
<p>This guide will explain how to use PostgreSQL and MariaDB on CentOS 7 64-bit with HylaFAX Enterprise.</p>
<ol>
<li>Configure ODBC Database Server
2.1. PostgreSQL installation</li>
</ol>
<h1 id="yum-install-postgresql-server-postgresql-odbc">yum install postgresql-server postgresql-odbc<a class="headerlink" href="#yum-install-postgresql-server-postgresql-odbc" title="Permanent link">&para;</a></h1>
<h1 id="postgresql-setup-initdb">postgresql-setup initdb<a class="headerlink" href="#postgresql-setup-initdb" title="Permanent link">&para;</a></h1>
<h1 id="systemctl-enable-postgresql">systemctl enable postgresql<a class="headerlink" href="#systemctl-enable-postgresql" title="Permanent link">&para;</a></h1>
<p>2.1.1. Configure PostgreSQL
Edit /var/lib/pgsql/data/pg_hba.conf:
Add the authentication line BEFORE the default ident lines:
local   hylafax        hylafax                                  md5
host    hylafax        hylafax       127.0.0.1/32               md5
host    hylafax        hylafax       ::1/128                    md5</p>
<h1 id="if-you-need-network-access-use-something-like">If you need network access, use something like:<a class="headerlink" href="#if-you-need-network-access-use-something-like" title="Permanent link">&para;</a></h1>
<p>host    hylafax        hylafax       192.168.1.0/24             md5
The file is well commented.
Edit /var/lib/pgsql/data/postgresql.conf
Important variables are:
    listen_addresses = 'localhost'
    max_connections = 512
    shared_buffers = 1024
max_connections needed are (minimum):
    2 * N + 1 + n + H
where:
    N is the number of channels
    1 is for faxq
    n is the number of simultaneous faxq job preparations (n &lt;= N)
    H is the number of simultaneous hfaxd connections
These  minimum  settings  do  not  take  into  account  any  other  necessary  connections  from  non-hylafax
related processes (like any other tools/scripts, or anything that faxrcvd might do, etc).
2
2.1.2. Start PostgreSQL</p>
<h1 id="systemctl-start-postgresql">systemctl start postgresql<a class="headerlink" href="#systemctl-start-postgresql" title="Permanent link">&para;</a></h1>
<p>2.1.3. Create HylaFAX User/Database for PostgreSQL</p>
<h1 id="su-postgres">su - postgres<a class="headerlink" href="#su-postgres" title="Permanent link">&para;</a></h1>
<p>$ createdb hylafax
$ createuser -A -D -P hylafax
Password: ee
$ createlang plpgsql hylafax
$ exit
2.1.4. Import HylaFAX Schema</p>
<h1 id="psql-u-hylafax-hylafax-varspoolhylafaxifaxsqlpostgressql">psql -U hylafax hylafax &lt; /var/spool/hylafax/ifax/sql/postgres.sql<a class="headerlink" href="#psql-u-hylafax-hylafax-varspoolhylafaxifaxsqlpostgressql" title="Permanent link">&para;</a></h1>
<p>2.1.5. Setup ODBC
Edit /etc/odbc.ini
[hylafax]
Driver      = /usr/lib64/psqlodbc.so
Database    = hylafax
Server      = localhost
UserName    = hylafax
Password    = ee
ReadOnly    = No
Debug       = 0
CommLog     = 0
UseServerSidePrepare = 0
3
2.2. MariaDB installation</p>
<h1 id="yum-install-mariadb-mariadb-server-mysql-connector-odbc">yum install mariadb mariadb-server mysql-connector-odbc<a class="headerlink" href="#yum-install-mariadb-mariadb-server-mysql-connector-odbc" title="Permanent link">&para;</a></h1>
<h1 id="systemctl-start-mariadb">systemctl start mariadb<a class="headerlink" href="#systemctl-start-mariadb" title="Permanent link">&para;</a></h1>
<h1 id="systemctl-enable-mariadb">systemctl enable mariadb<a class="headerlink" href="#systemctl-enable-mariadb" title="Permanent link">&para;</a></h1>
<p>2.2.1. Create HylaFAX User/Database on MariaDB</p>
<h1 id="mysqladmin-create-hylafax">mysqladmin create hylafax<a class="headerlink" href="#mysqladmin-create-hylafax" title="Permanent link">&para;</a></h1>
<h1 id="mysql-mysql">mysql mysql<a class="headerlink" href="#mysql-mysql" title="Permanent link">&para;</a></h1>
<p>Execute these SQL queries:
GRANT ALL PRIVILEGES ON hylafax.* TO 'hylafax'@'localhost' IDENTIFIED BY 'ee';
If you need network access, use something like:
GRANT ALL PRIVILEGES ON hylafax.* TO 'hylafax'@'209.166.32.52' IDENTIFIED BY 'ee';
Update privileges:
FLUSH PRIVILEGES;
exit;
2.2.2. Import HylaFAX Schema</p>
<h1 id="mysql-uhylafax-pee-hylafax-varspoolhylafaxifaxsqlmysqlsql">mysql -uhylafax -pee hylafax &lt; /var/spool/hylafax/ifax/sql/mysql.sql<a class="headerlink" href="#mysql-uhylafax-pee-hylafax-varspoolhylafaxifaxsqlmysqlsql" title="Permanent link">&para;</a></h1>
<p>2.2.3. Setup ODBC
Edit /etc/odbc.ini
[hylafax]
Driver      = /usr/lib64/libmyodbc5.so
Database    = hylafax
Server      = localhost
User        = hylafax
Password    = ee
;ReadOnly   = No
4
3. Test the ODBC Connection
Test the connection using isql hylafax
[root@hylafax ~]# isql hylafax
+----------------------------------------+
| Connected!                             |
|                                        |
| sql-statement                          |
| help [tablename]                       |
| quit                                   |
|                                        |
+----------------------------------------+
SQL&gt; SELECT count(*) FROM hylafax_statements;
+-----------------+
| count           |
+-----------------+
| 13              |
+-----------------+
SQLRowCount returns 1
1 rows fetched
SQL&gt; quit
4. Configure HylaFAX Enterprise with ODBC
Create /var/spool/hylafax/etc/CONFIG/database with the following content:
DataInitialize:    "odbc: dsn=hylafax"</p>
<h1 id="dataoption-odbc-usernamehylafax">DataOption:       "odbc: username=hylafax"<a class="headerlink" href="#dataoption-odbc-usernamehylafax" title="Permanent link">&para;</a></h1>
<h1 id="dataoption-odbc-passwordee">DataOption:       "odbc: password=ee"<a class="headerlink" href="#dataoption-odbc-passwordee" title="Permanent link">&para;</a></h1>
<p>DataSource:        "FaxRecvInfo: odbc"
DataSource:        "FaxAcctInfo: odbc"
Afterwards, configure your modem devices to include that file. For example, in
/var/spool/hylafax/etc/CONFIG/boston add:
Include:           etc/CONFIG/database
Next, restart faxgetty and/or btgetty proccesses in order to connect them to ODBC:</p>
<h1 id="for-i-in-varspoolhylafaxfifo-do-echo-q-i-done">for i in /var/spool/hylafax/FIFO.*; do echo Q &gt; $i; done<a class="headerlink" href="#for-i-in-varspoolhylafaxfifo-do-echo-q-i-done" title="Permanent link">&para;</a></h1>
<p>5</p>
<p>If there is an ODBC connection problem, the faxgetty/btgetty processes will fail to start
properly.
You  can  verify  whether  there  were  errors  while  connecting  to  the  database  by
executing:</p>
<h1 id="grep-i-odbc-varlogmessages">grep -i odbc /var/log/messages<a class="headerlink" href="#grep-i-odbc-varlogmessages" title="Permanent link">&para;</a></h1>
<p>If HylaFAX is having difficulty connecting to ODBC, try uncommenting the
'DataOption' lines above.
Should  you  need  to  disable  ODBC,  simply  comment  out  the  Include  line  you  added
above.
5. Retrieving Data from ODBC
Here are sample SQL queries for retrieving records from the 'communication' table:
SELECT tstart, command, commid, jobid, mailaddr, dest, csi, npages, status
FROM communication WHERE dest = '12155558774';
SELECT tstart, commid, device, jobid, npages, status FROM communication
ORDER BY tstart DESC LIMIT 40;
 A description of each column can be found in the xferfaxlog manpage.
6. Populating the Database
You  can  use  the  xferfaxlog2db.php  script  from  http://people.ifax.com/~david/scripts/  to  export  your
xferfaxlog  data  into  the  ODBC  database.  Only  records  not  currently  available  in  the  database  will  be
created.
6
7. Checking a job’s final status
The HylaFAX job 'status' is available in the 'status' column of the 'communication' table. On success, the
status field will be empty. A call that ended with an error will report the error in the 'status' column.
Please  note  that  the  /var/spool/hylafax/etc/xferfaxlog  data  and  the  'communication'  database  table
contain call detail records. If you want to know the final status of a job, it’s better to add that column to
the database and then update it via the FaxNotify script.
For example, you’d add the following to /var/spool/hylafax/etc/FaxNotify:</p>
<h1 id="add-final-status-eg-done-failed-etc-to-the-communication-table">Add final status (e.g. 'done', 'failed', etc) to the communication table<a class="headerlink" href="#add-final-status-eg-done-failed-etc-to-the-communication-table" title="Permanent link">&para;</a></h1>
<h1 id="see-man-notify-for-list-of-statuses">See <code>man notify</code> for list of statuses<a class="headerlink" href="#see-man-notify-for-list-of-statuses" title="Permanent link">&para;</a></h1>
<p>DB=hylafax
USER=hylafax
PASS=ee
case "<span class="arithmatex">\(WHY" in
  blocked)    ;;
  requeued)   ;;
  *) echo "UPDATE communication SET finalstatus='\)</span>WHY' WHERE commid = '$COMMID'" | isql
$DB $USER $PASS
   ;;
esac
You must apply the following schema change for both PostgreSQL and MariaDB:
ALTER TABLE communication ADD finalstatus VARCHAR(20) DEFAULT NULL;
You must also apply the following schema change for MariaDB:
ALTER TABLE communication CHANGE tstart tstart TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
Once  you’ve  applied  these  changes,  you’ll  be  able  to  query  the  database  regarding  jobs  where  the
finalstatus is not null and get the true final status of the job.
SELECT * FROM communication WHERE command = 'SEND' AND finalstatus is not null;
7
You can use the following queries to retroactively set the finalstatus column:
UPDATE communication SET finalstatus='done' WHERE command = 'SEND' AND finalstatus is
null AND status is null;
UPDATE communication SET finalstatus='failed' WHERE command = 'SEND' AND finalstatus is
null AND status like '%too many%';</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.c7dec7e7.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.da79ceb7.min.js"></script>
      
    
  </body>
</html>